<div class="container">
<div class="row">

        <div id="dataDinamica"></div>


    {{!-- <div class="col-4">
        <div class="card" style="width: 18rem;">
            <img src="/img/globo.jpeg" class="card-img-top" alt="...">
            <div class="card-body">
                <h5 class="card-title fs-2"> Chaleco globo</h5>
                <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
                <hr class="w-100">
                <h4> $ 45.000 </h4>
                <a href="#" class="btn btn-warning">Agregar al carrito</a>
            </div>
        </div>
    </div>

    <div class="col-4">
        <div class="card" style="width: 18rem;">
            <img src="/img/nube.jpeg" class="card-img-top" alt="...">
            <div class="card-body">
                <h5 class="card-title fs-2">Chaleco nube</h5>
                <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
                <hr class="w-100">
                <h4> $ 47.000 </h4>               
                <a href="#" class="btn btn-warning">Agregar al carrito</a>
            </div>
        </div>
    </div>

    <div class="col-4">
        <div class="card" style="width: 18rem;">
            <img src="/img/rayas.jpeg" class="card-img-top " alt="...">
            <div class="card-body">
                <h5 class="card-title fs-2" >Chaleco rayas</h5>
                <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
                <hr class="w-100">
                <h4> $ 49.000 </h4>               
                <a href="#" class="btn btn-warning">Agregar al carrito</a>
            </div>
        </div>
    </div>
         --}}
</div>
</div>
 {{>modal}}

<script>
    const dinamica = document.getElementById("dataDinamica");
    const resultadoCarrito = document.getElementById("resultadoCarrito")
    const carritoCompra = [];

        document.addEventListener('DOMContentLoaded', async() => {
         try{
             const res = await fetch("/api/productos", {
             method: 'get',
         })
      const data = await res.json()
      pintarDatos(data.msg)

    document.addEventListener("click", (e) => {
    if (e.target.dataset.buton === "producto") {
        carritoCompra.push(e.target.dataset.prenda);
        e.target.classList.add("disabled");
        console.log(carritoCompra);
      
        pintarCarrito(data.msg);
            }
        });

      }catch(error){
        console.log(error)
      }   
});

const pintarDatos = (data) => {
    data.forEach(d => {
         return  dinamica.innerHTML += `
        
            <div class="col-4 mt-4 ms-4">
        <div class="card" style="width: 18rem;">
            <img src="/img/${d.producto.split(" ", 2)[1]}.jpeg" class="card-img-top " alt="chalecos tejidos">
            <div class="card-body">
                <h5 class="card-title fs-2"> ${d.producto}</h5>
                <p class="card-text">${d.descripcion}</p>
                <hr class="w-100">
                <h4>${d.valor}</h4>
                 <button type="button" class="btn btn-success" data-prenda="${d.id}" data-buton="producto">
                Agregar</button>
            </div>
        </div>
    `
    })
}


const pintarCarrito = (data) => {
    console.log(data)
    resultadoCarrito.innerHTML = "";
 
    carritoCompra.forEach((prenda) => {
         const resultado = data.find(elemento => elemento.id == prenda)
console.log(resultado)
        resultadoCarrito.innerHTML +=

        `
        <div class="card mb-3" style="max-width: 540px;">
        <div class="row g-0">
            <div class="col-md-4">
            <img src="/img/${resultado.producto.split(" ", 2)[1]}.jpeg" class="img-fluid rounded-start" alt="...">
            </div>
            <div class="col-md-8">
            <div class="card-body">
                <h5 class="card-title">${resultado.producto}</h5>
                <p class="card-text">${resultado.descripcion}</p>
                <p class="card-text"><small class="text-muted">${resultado.valor}</small></p>
            </div>
            </div>
        </div>
        </div>`
    });
};

</script>